import pyttsx3
import datetime
import speech_recognition as sr
import wikipedia
import webbrowser
import os
try:
    engine=pyttsx3.init('sapi5')
    voices=engine.getProperty('voices')
    print(voices[0].id)
    engine.setProperty('voice',voices[0].id)

    def speak(audio):
        engine.say(audio)
        engine.runAndWait()
    def wishme():
        hour=int(datetime.datetime.now().hour)
        if hour>=0 and hour<12:
            speak('Good Morning Vicky')
        elif hour>=12 and hour>=17:
            speak('Good Afternoon Vicky')
        else:
            speak('Good Evening')
        print('Hellow I am Computer, How can I help you!')
        speak('Hellow I am Computer, How can I help you!')
    def takecommand():
        r=sr.Recognizer()
        with sr.Microphone() as source:
            print('Listening....')
            r.pause_threshold=1
            
            audio=r.listen(source)
        try:
            print('Recognizing....')
            querry=r.recognize_google(audio,language='en-in')
            print(f'You said {querry}')
        except Exception:
            print('Say That Again Please!')
            return 'None'
        return querry


    if __name__ == "__main__":
        wishme()
        while True:
            querry=takecommand().lower()
            if 'wikipedia' in querry:
                speak('Searching wikipedia...')
                querry=querry.replace('wikipedia','')
                querry=querry.replace('please','')
                
                results=wikipedia.summary(querry,sentences=2)
                speak('According to wikipedia, ')
                print(results)
                speak(results)
            elif 'who are you' in querry:
                print('I am Computer Sir!')
                speak('I am Computer Sir!')
            elif 'made you' in querry:
                print('I am made by you Sir Waqas powered by Vicky World Production')
                speak('I am made by you Sir Waqas powered by Vicky World Production')


                
            elif 'open youtube' in querry:
                webbrowser.open('youtube.com')
                speak('Youtube has been opened dear Vicky')
                
            elif 'open google' in querry:
                webbrowser.open('google.com')
                speak('Google Has been opened dear Vicky')
                
            elif 'stack overflow' in querry:
                webbrowser.open('stackoverflow.com')
            elif 'stackoverflow' in querry:
                webbrowser.open('stackoverflow.com')
            elif 'time' in querry:
                str=datetime.datetime.now().strftime('%H:%M:%S')
                print(f"Time is{str}")
                speak(f"Time is {str}")
            

            elif 'search' in querry:
                querry=querry.replace('search','')
                querry=querry.replace('please','')
                webbrowser.open(querry)
            elif 'song' in querry:
                music_dir=r'D:\New folder (2)'
                songs=os.listdir(music_dir)
                print(songs[36])
                os.startfile(os.path.join(music_dir,songs[36]))

            elif 'stop' in querry:
                print('Computer has been stopped Thank You Sir!')
                speak('Computer has been stopped Thank You Sir!')

                break
            elif 'quit' in querry:
                print('Computer has been stopped. Thank You Sir!')
                speak('Computer has been stopped. Thank You Sir!')
                break
            speak('Again tell what you want to me')
except Exception as e:
    speak('An unknown Error has been occured')